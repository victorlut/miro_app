<html>
    <head>
        <title>Miro - FluidMemory</title>
        <link rel="stylesheet" href="https://unpkg.com/mirotone/dist/styles.css" />
        <link rel="stylesheet" href="https://unpkg.com/metismenu/dist/metisMenu.min.css" />
        <link rel="stylesheet" href="src/style.css" />
        <link rel="stylesheet" href="src/material-icons.css" />
    </head>
    <body>
        <div class="sidebar__content">
            <div id="stat-container" class="stat-list">
                <div class="stat-list__header">
                    <span>FluidMemory</span>
                    <img src="src/content_paste_FILL0_wght400_GRAD0_opsz48.png" style="width: 29px;top: 18px;right: 60px;position: absolute;cursor: pointer;" id="paste_btn">
                </div>
                <div class="tabs">
                    <div class="tabs-header-list">
                        <!-- <div tabindex="0" class="tab tab-active" data-tabbtn="tab-cluster">
                            <div class="tab-text tab-cluster">Group</div>
                        </div> -->
                        <div tabindex="1" class="tab tab-active" data-tabbtn="tab-count">
                            <div class="tab-text tab-count">Count</div>
                        </div>
                        <div tabindex="2" class="tab" data-tabbtn="tab-search">
                            <div class="tab-text tab-search">Search</div>
                        </div>
                        <div tabindex="3" class="tab" data-tabbtn="tab-snapshots">
                            <div class="tab-text tab-snapshots">Snapshot</div>
                        </div>
                        <div tabindex="3" class="tab" data-tabbtn="tab-about">
                            <div class="tab-text tab-about">About</div>
                        </div>
                    </div>
                </div>
                <!-- <div class="tab-panel active" id="tab-cluster">
                    <div class="menu-wrapper">
                        <label>Group</label>
                        <ul class="metisMenu" id="clusterList"></ul>
                    </div>
                    <div class="action">
                        <button class="button button-primary" id="createGroupApply">Create Group</button>
                    </div>
                </div> -->
                <div class="tab-panel active" id="tab-count">
                    <div class="form-group">
                        <label>Tag</label>
                        <select class="select" id="tag-select">
                            <option value="tag1">Tag 1</option>
                            <option value="tag2">Tag 2</option>
                            <option value="tag3">Tag 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Stop list</label>
                        <textarea class="textarea" placeholder="Write keywords(default: 'i, me, my, myself, ...')" id="stopList" spellcheck="true" rows="4"></textarea>
                    </div>
                    <div class="action btn-group" role="group">
                        <button class="button button-primary" id="countWordApply">Apply</button>
                    </div>

                    <ul class="metisMenu" id="metismenu"></ul>
                </div>
                <div class="tab-panel" id="tab-search">
                    <div class="form-group">
                        <label>Select keywords (comma-separated)</label>
                        <textarea class="textarea" placeholder="Write keywords" id="searchKeywords" spellcheck="true" rows="4"></textarea>
                    </div>
                    <div class="action">
                        <button class="button button-primary" id="searchApply">Search</button>
                        <button class="button button-secondary button-small" id="createTagApply">New Tag</button>
                    </div>
                    <div class="menu-wrapper" style="margin-top: 15px;">
                        <label>Tags</label>
                        <ul class="metisMenu" id="tagList"></ul>
                    </div>
                    <!-- <div class="action">
                        <button class="button button-primary" id="createTagApply">Create tag</button>
                    </div> -->
                </div>
                <div class="tab-panel" id="tab-snapshots">
                    <div class="action">
                        <button class="button button-primary" id="addSnapshot">Apply</button>
                    </div>
                    <ul class="metisMenu" id="snapshotList"></ul>
                </div>
                <div class="tab-panel" id="tab-about" style="padding: 15px; padding-top: 15px">
                    <p style="text-align: center;">
                        <img src="./src/logo.svg" style="width: 100px;"/>
                    </p>
                    <p>
                        <a class="link link-primary" target="_parent" href="https://eightarms.bit.ai/docs/view/33zXPjGB7W6AXCGI">FluidMemory</a> is a user-friendly qualitative data analysis solution that enables teams to collect and analyze written content, including notes, analyst reports, and
                        presentations, across multiple tools including Miro, Mural, Google Sheets, Google Docs, and Google Slides
                    </p>
                    <p>
                        FluidMemory was designed to be intuitive and easy to use. However, sometimes we all run into a challenge here and there. Click on the button to go to our
                        <a class="link link-primary" href="https://eightarms.bit.ai/docs/view/33zXPjGB7W6AXCGI" target="_parent">support site</a> and find resources to help you get the most out of our application.
                    </p>
                </div>
            </div>
        </div>
        <div class="loading-wrapper">
            <div class="loading"></div>
        </div>

        <script src="https://unpkg.com/jquery"></script>
        <script src="https://unpkg.com/metismenu"></script>
        <script src="https://miro.com/app/static/sdk.1.1.js"></script>
        <script src="src/sidebar.js"></script>
        <script src="src/counter.js"></script>
        <script src="src/snapshot.js"></script>
        <script src="src/search.js"></script>
        <!-- <script src="src/cluster.js"></script> -->
        <script>
            miro.onReady(async () => {
                metaData = await miro.board.metadata.get();

                if (!metaData[appId]) {
                    metaData[appId] = { appId };
                    await miro.board.metadata.update(metaData);
                }

                await checkDataForFluidMemory();

                loadTagSelectOptions();
            });

            var pastebtn = $("#paste_btn")
            // pastebtn.onclick(function() {
            //     document.execCommand('paste')
            //     let keydown = new KeyboardEvent('keydown', {key: 'v', code: 'KeyV', keyCode: 86, ctrlKey: true})
            //     document.dispatchEvent(keydown)
            // })

            pastebtn.bind("click", function(e) {    
                window.navigator.clipboard.readText().then(text => {
                    console.log(text)
                })
                console.log(window.navigator.clipboard.readText())
                document.execCommand('paste')
                let keydown = new KeyboardEvent('keydown', {key: 'v', code: 'KeyV', keyCode: 86, ctrlKey: true})
                document.dispatchEvent(keydown)
                console.log('paste button click')
                createStickyNote(e)
            })
            $('[data-tabbtn]').on('click', (e) => {
                tabId = $(e.currentTarget).attr('data-tabbtn');
                $('.tab-panel').removeClass('active');
                $(`#${tabId}`).addClass('active');
                $('[data-tabbtn]').removeClass('tab-active');
                $(e.currentTarget).addClass('tab-active');

                if (tabId == 'tab-count') {
                    loadTagSelectOptions();
                } else if (tabId == 'tab-snapshots') {
                    loadSnapshotsToList();
                } else if (tabId == 'tab-search') {
                    loadTagList();
                }
                // } else if (tabId == 'tab-cluster') {
                //     loadGroupsToList();
                // }
            });
        </script>
    </body>
</html>
